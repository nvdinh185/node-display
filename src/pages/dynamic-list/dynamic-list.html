<ion-header>
    <ion-navbar>

        <ion-buttons *ngIf="!isSearch && dynamicList?.search_bar" start>
            <button ion-button icon-only color="royal" (click)="goSearch()">
                <ion-icon name="search"></ion-icon>
            </button>
        </ion-buttons>

        <ion-buttons end *ngFor="let btn of dynamicList?.buttons">
            <button ion-button icon-only color="{{btn.color}}" (click)="onClickHeader(btn)">
                <ion-icon name="{{btn.icon}}"></ion-icon>
            </button>
        </ion-buttons>

        <!-- <ion-searchbar *ngIf="isSearch && dynamicList?.search_bar" placeholder="{{dynamicList?.search_bar.hint}}"
            [(ngModel)]="searchString" [showCancelButton]="shouldShowCancel" (ionInput)="onInput($event)" (keyup.enter)="searchEnter()"
            (keyup.esc)="searchEnter()" start>
        </ion-searchbar> -->
        <div *ngIf="isSearch && dynamicList?.search_bar"
             style="width: 100%; z-index: 999;position: absolute;">
                <ng-template #withFlags let-attrs="attrs">
                  <span [innerHTML]="attrs.data.site_id +'- '+attrs.data.name | boldprefix:attrs.keyword"></span>
                </ng-template>
            <ion-auto-complete #searchbar 
                            [template]="withFlags"
                            [dataProvider]="apiAutoComplete"
                            (itemSelected)="searchSelect($event)">
            </ion-auto-complete >
        </div>

        <ion-title *ngIf="!isSearch">{{dynamicList?.title}}</ion-title>

    </ion-navbar>
</ion-header>

<ion-content class="list-avatar-page">
    <ion-list>

        <ion-item-sliding #slidingItem class="background-list" *ngFor="let it of dynamicList.items; let idx = index">
            
                <ion-item #item class="background-item" tappable (click)="onClickDetails(slidingItem,it,0)">
                    <ion-icon item-start *ngIf="!it.image&&it.icon" name="{{it.icon}}" color="{{it.color}}"></ion-icon>
                    <ion-avatar *ngIf="it.image" item-start>
                        <img [src]="it.image">
                    </ion-avatar>
                    <ion-title >{{it.title}}</ion-title>
                    <p text-wrap>{{it.content}}</p>
                    <ion-note item-end>
                        {{it.note | timeAgo}}
                        <p style="text-align: right;" *ngIf="it.alert">
                            <ion-badge color="danger">{{ it.alert?.length }}</ion-badge>
                        </p>
                    </ion-note>
                </ion-item>
    
                <ion-item-options>
                    <button ion-button color="bg-blue" (click)="onClickDetails(slidingItem, it, 1)">
                        <ion-icon name="ios-arrow-dropup"></ion-icon>
                        Pin
                    </button>
                    <button ion-button color="secondary" (click)="onClickDetails(slidingItem, it, 2)">
                        <ion-icon name="volume-off"></ion-icon>
                        Mute
                    </button>
                    <button ion-button color="danger" (click)="onClickDetails(slidingItem, it, 3)">
                        <ion-icon name="trash"></ion-icon>
                        Delete
                    </button>
                </ion-item-options>
    
                <ion-item-options side="left">
                    <button ion-button color="primary" expandable (click)="onClickDetails(slidingItem, it, 4)">
                        <ion-icon name="checkmark"></ion-icon>
                        <div>Read</div>
                        <ion-spinner id="archive-spinner"></ion-spinner>
                    </button>
                </ion-item-options>

        </ion-item-sliding>

    </ion-list>
</ion-content>